# CiviCRM 5.6.0

Released October 3, 2018

- **[Synopsis](#synopsis)**
- **[Features](#features)**
- **[Bugs resolved](#bugs)**
- **[Miscellany](#misc)**
- **[Credits](#credits)**
- **[Feedback](#feedback)**

## <a name="synopsis"></a>Synopsis

| *Does this version...?*                                         |         |
|:--------------------------------------------------------------- |:-------:|
| Fix security vulnerabilities?                                   |         |
| Change the database schema?                                     |         |
| Alter the API?                                                  |         |
| Require attention to configuration options?                     |         |
| Fix problems installing or upgrading to a previous version?     |         |
| Introduce features?                                             |         |
| Fix bugs?                                                       |         |

## <a name="features"></a>Features

### Core CiviCRM

- **Improve styling of address block on summary screen
  ([12723](https://github.com/civicrm/civicrm-core/pull/12723))**

  This changes the display of the address block to be more consistent with the
  way that email and website are displayed on a contact.

- **Foreign key for civicrm_custom_field.option_group_id
  ([12706](https://github.com/civicrm/civicrm-core/pull/12706))**

  This change adds a foreign key for option group id to the custom field table.

### CiviMember

- **Enable custom data display on MembershipType form
  ([12738](https://github.com/civicrm/civicrm-core/pull/12738))**

  This makes it so if Membership Type custom fields are configured they are
  displayed on the Membership Type form.

## <a name="bugs"></a>Bugs resolved

### CiviReport

- **[dev/core#325](https://lab.civicrm.org/dev/core/issues/325) Fatal error 'DB Error: no
  such field' on Contribution detail report
  ([12660](https://github.com/civicrm/civicrm-core/pull/12660))**

  This change fixes a bug where on the Contribution Detail report, selecting the
  "Age" column would result in a fatal error so that the report includes Age as
  expected.
  
### CiviMail

- **[dev/mail#20](https://lab.civicrm.org/dev/mail/issues/20) Preview screen
  don't open until recipients list is built on mail compose screen
  ([12509](https://github.com/civicrm/civicrm-core/pull/12509))**

  This change fixes a bug where when drafting a mailing one could not open the
  preview mailing screen until the recipient count query had completed.

- **[dev/core#352](https://lab.civicrm.org/dev/core/issues/352) Ensure that when
  adding recipients of previous mailings that contacts who are being excluded
  are removed ([12712](https://github.com/civicrm/civicrm-core/pull/12712))**

  This change makes sure when using recipients from a previous mailing as the
  recipients of a mailing That any exclusions are respected.

### CiviContribute

- **[dev/core#299](https://lab.civicrm.org/dev/core/issues/299) Decimal point
  error. ([12684](https://github.com/civicrm/civicrm-core/pull/12684))
  (Continuation of work)**

  This change localizes the display of the amount on the update payment details
  form.

### Drupal Integration

- **[dev/core#311](https://lab.civicrm.org/dev/core/issues/311) Upgrading
  multilingual site causes DB Error
  ([12636](https://github.com/civicrm/civicrm-core/pull/12636))**

  This change fixes a bug where upgrading a multilingual drupal site from
  CiviCRM 4.4.7 to 5.4.0 causes a DB error so that one can upgrade a
  multilingual drupal site without a DB error.

### Core CiviCRM

- **Handle smart groups created in previous Civis which include
  relation_permission
  ([12804](https://github.com/civicrm/civicrm-core/pull/12804))**

  This change fixes a bug where smart groups created in CiviCRM 5.4 based on a
  search using a relationship break in CiviCRM 5.5 so that they work as
  expected.

- **[dev/core#346](https://lab.civicrm.org/dev/core/issues/346) Online Pay Now
  error when used from dashboard checksum link
  ([12745](https://github.com/civicrm/civicrm-core/pull/12745))**

  This change fixes a bug where when a user accessed the CiviCRM user dashboard
  using a checksum and then clicked the paynow link, the paynow link would
  break, so that the pay now link takes you to pay now as expected.

- **Show ext version status even when directory not writeable
  ([12757](https://github.com/civicrm/civicrm-core/pull/12757))**

  This change fixes a bug where extension updates were not showing if the
  extension directory was not writable so that information about extension
  updates are shown on the extensions tab regardless of whether the extension
  directory is writabale.

- **Remove mcrypt warning except for affected sites.
  ([12733](https://github.com/civicrm/civicrm-core/pull/12733))**

  This change makes it so that the System Check that warns people that mcrypt is
  not available only shows on sites that store smtp passwords in their database
  (the only users for whom this warning is applicable).

- **[dev/core#367](https://lab.civicrm.org/dev/core/issues/367) Fatal error /
  SQL timeout in A-Z pager for advanced search by relationship with target group
  for reciprocal relationship types
  ([12740](https://github.com/civicrm/civicrm-core/pull/12740))**

  This change fixes a bug where advanced searches on reciprocal relationships
  (ex: "spouse") and using the criteria "target contact is in group" on sites
  with large numbers of relationships of that type would take a long time,
  occasionally timing out entirely.

- **[dev/core#343](https://lab.civicrm.org/dev/core/issues/343) Long lines in
  contact name or address overflow mailing labels
  ([12691](https://github.com/civicrm/civicrm-core/pull/12691))**

  This change fixes a bug where PDF Mailing Labels generated by civi were not
  wrapping appropriately so that they wrap and do run off the label.

- **[dev/core#351](https://lab.civicrm.org/dev/core/issues/351) ERROR: LoadForm
  Pop-up w/out Params in URL
  ([12735](https://github.com/civicrm/civicrm-core/pull/12735))**

  This change fixes a bug where the load form function used to open a form in a
  pop up window was throwing an error if no parameters were included in the URL
  so no error is thrown if no parameters are sent (and no parameters are
  necessary).

- **[dev/core#349](https://lab.civicrm.org/dev/core/issues/349) Scheduled reminders list default sort does not work ([12701](https://github.com/civicrm/civicrm-core/pull/12701))**

- **[dev/translation#14](https://lab.civicrm.org/dev/translation/issues/14) InnoDB Advanced Logging cannot be enabled on multi-lingual ([12667](https://github.com/civicrm/civicrm-core/pull/12667))**

- **Fix recent item deduping & call hooks ([12704](https://github.com/civicrm/civicrm-core/pull/12704))**

- **Remove net_amount from the Back office contribution form. ([12662](https://github.com/civicrm/civicrm-core/pull/12662))**

- **Fix Undefined index: params in CRM_Event_BAO_Event::buildCustomProfile() ([12678](https://github.com/civicrm/civicrm-core/pull/12678))**

- **BASW-240: 'Network Error' when creating membership type from contact membership tab ([12700](https://github.com/civicrm/civicrm-core/pull/12700))**

- **[dev/mail#21](https://lab.civicrm.org/dev/mail/issues/21) send test email may create duplicate contacts ([12599](https://github.com/civicrm/civicrm-core/pull/12599))**

- **[dev/core#334](https://lab.civicrm.org/dev/core/issues/334) Public contribution form and Checksums: billing information not loaded if using multiple processors ([12679](https://github.com/civicrm/civicrm-core/pull/12679))**

- **Get title for event tell a friend mail ([12699](https://github.com/civicrm/civicrm-core/pull/12699))**

- **Wrap long labels onto multiple lines to prevent text being cut off ([12716](https://github.com/civicrm/civicrm-core/pull/12716))**

- **[dev/core#297](https://lab.civicrm.org/dev/core/issues/297) permission "access my cases and activities" is broken by CRM-21461 ([12613](https://github.com/civicrm/civicrm-core/pull/12613))**

- **Corrected tag_id parameter description to refer cases ([12726](https://github.com/civicrm/civicrm-core/pull/12726))**

- **Added Pseudoconstant for phone and website type ([12727](https://github.com/civicrm/civicrm-core/pull/12727))**

- **Fix ReportInstance BAO to call post hook after save (instead of calling pre twice). ([12722](https://github.com/civicrm/civicrm-core/pull/12722))**

- **Contact summary - adjust block width when editing ([12708](https://github.com/civicrm/civicrm-core/pull/12708))**

- **Minor comment and typo cleanup ([12715](https://github.com/civicrm/civicrm-core/pull/12715))**

- **Added Pseudoconstant tag for visibility ([12705](https://github.com/civicrm/civicrm-core/pull/12705))**

- **Navigation - Don't reprocess fully-formed urls ([12702](https://github.com/civicrm/civicrm-core/pull/12702))**

- **[dev/joomla#2](https://lab.civicrm.org/dev/joomla/issues/2) Joomla cron.php/cli.php fail on Windows server ([12692](https://github.com/civicrm/civicrm-core/pull/12692))**

- **Use static cache for UFMatch lookups to improve performance ([12628](https://github.com/civicrm/civicrm-core/pull/12628))**

- **Add test for new rounded money format functions ([12689](https://github.com/civicrm/civicrm-core/pull/12689))**

- **[dev/core#119](https://lab.civicrm.org/dev/core/issues/119) Notice error ([12626](https://github.com/civicrm/civicrm-core/pull/12626))**

- **[dev/core#341](https://lab.civicrm.org/dev/core/issues/341) "Contributions made in Year X and not Year Y" custom search ignores date field ([12686](https://github.com/civicrm/civicrm-core/pull/12686))**

- **[dev/core#322](https://lab.civicrm.org/dev/core/issues/322) Contribution page, completing this form on behalf of someone else: JavaScript error for checkbox field
([12652](https://github.com/civicrm/civicrm-core/pull/12652))**

- **Code cleanup on Membership form when freezing fields in a recurring exists situation ([12642](https://github.com/civicrm/civicrm-core/pull/12642))**

- **Replicate fix on PR #12643 for pledge report ([12685](https://github.com/civicrm/civicrm-core/pull/12685))**

- **[dev/core#217](https://lab.civicrm.org/dev/core/issues/217) Allow replacement of PrevNextCache implementation (for search screens) ([12664](https://github.com/civicrm/civicrm-core/pull/12664) and [12663](https://github.com/civicrm/civicrm-core/pull/12663))**

- ** Ensure users with the perm "CiviEvent: access CiviEvent " can edit events they have created. ([12424](https://github.com/civicrm/civicrm-core/pull/12424))**

- **don't add query to developer tab if we are downloading the data ([12666](https://github.com/civicrm/civicrm-core/pull/12666))**

- **Fixed fatal error when Gender is selected in column ([12661](https://github.com/civicrm/civicrm-core/pull/12661))**

- **Add SQL modes to developer tab ([12656](https://github.com/civicrm/civicrm-core/pull/12656))**

- **Export minor refactor Move household relationship types to the processor ([12579](https://github.com/civicrm/civicrm-core/pull/12579))**

- **GL-44 admin price field options on event info page ([11923](https://github.com/civicrm/civicrm-core/pull/11923))**

- **filter current employer report by all groups ([12643](https://github.com/civicrm/civicrm-core/pull/12643))**

- **Drop custom CSS for Joomla CiviCRM menu so it works with shoreditch theme ([12632](https://github.com/civicrm/civicrm-core/pull/12632))**

- **[dev/core#237](https://lab.civicrm.org/dev/core/issues/237) Hide Drupal8 Administer Menu bar on CiviCRM pages ([12463](https://github.com/civicrm/civicrm-core/pull/12463))**

- **Fix CRM_ACL_API::whereClause to respect $contactId param ([12576](https://github.com/civicrm/civicrm-core/pull/12576))**

- **[dev/accessibility#10](https://lab.civicrm.org/dev/accessibility/issues/10) Make datepicker accessible([12631](https://github.com/civicrm/civicrm-core/pull/12631))**

- **[dev/core#295](https://lab.civicrm.org/dev/core/issues/295) Default 'from' mail address is not the default one showing in 'send email' ([12603](https://github.com/civicrm/civicrm-core/pull/12603))**

- **Minor refactor, use sales tax trait to simplify sales tax functions ([12594](https://github.com/civicrm/civicrm-core/pull/12594))**

- **Upgrade symfony in lockfile to be 2.8 which is supported version of 2… ([12633](https://github.com/civicrm/civicrm-core/pull/12633))**

- **Make contact name into a link on Manage Case for single client ([12619](https://github.com/civicrm/civicrm-core/pull/12619))**

- **Follow up on #12611 - adding in three data-integrity assertions. ([12629](https://github.com/civicrm/civicrm-core/pull/12629))**

- **Use cached version of payment processor. ([12627](https://github.com/civicrm/civicrm-core/pull/12627))**

- **Activity display, switch to more performance getActivities function (from deprecatedGetActivities) ([12559](https://github.com/civicrm/civicrm-core/pull/12559))**

- **[dev/core#245](https://lab.civicrm.org/dev/core/issues/245) Duplicate activities shown on case tab ([12444](https://github.com/civicrm/civicrm-core/pull/12444))**

- **Bump recommended php version to 7.1 and min recommended to 7.0 ([12625](https://github.com/civicrm/civicrm-core/pull/12625))**

- **Don't duplicate activity when filing on case ([12620](https://github.com/civicrm/civicrm-core/pull/12620))**

- **Make sure Joomla timezone is set for cron jobs ([12609](https://github.com/civicrm/civicrm-core/pull/12609))**

- **Further removal of instance of using LOWER() rather than relying on mysql non-case-sensitivity. ([12612](https://github.com/civicrm/civicrm-core/pull/12612))**

- **Remove unused variables from process_participants job ([12621](https://github.com/civicrm/civicrm-core/pull/12621))**

- **Stop passing imProviders & phoneTypes - use CRM_Core_PseudoConstant:getLabel ([12608](https://github.com/civicrm/civicrm-core/pull/12608))**

- **pass mailingJobId to hook_tokenValues ([12026](https://github.com/civicrm/civicrm-core/pull/12026))**

- **API : Set current domain as a sensible default for payment processor ([12595](https://github.com/civicrm/civicrm-core/pull/12595))**

- **Drupal Views CiviCRM: Allow Participant record to be used from Event. ([539](https://github.com/civicrm/civicrm-drupal/pull/539))**


## <a name="misc"></a>Miscellany

- **Towards rationalising settings form & preferences form (partial of 12731)
  ([12732](https://github.com/civicrm/civicrm-core/pull/12732))**  

- **Fix compatibility problem with CRM_Extendedreport_Form_Report_ExtendedReport
  ([12749](https://github.com/civicrm/civicrm-core/pull/12749))**

- **Fix teeny typo
  ([12618](https://github.com/civicrm/civicrm-core/pull/12618))**

- **[PHPUnit test only] Adding in assertions re: Line Item and Contribution
  data-integrity.
  ([12611](https://github.com/civicrm/civicrm-core/pull/12611))**

- **[NFC] comment fixes relating to doc blocks, spelling
  ([12630](https://github.com/civicrm/civicrm-core/pull/12630))**

- **[phpunit test only] - Add one additional data integrity check to ensure that
  after Edit Fin…
  ([12645](https://github.com/civicrm/civicrm-core/pull/12645))**

- **NFC Add/update two comments
  ([12680](https://github.com/civicrm/civicrm-core/pull/12680))**

- **[NFC] Minor function extraction in report class.
  ([12658](https://github.com/civicrm/civicrm-core/pull/12658))**

- **(NFC) Fix incorrect reference of doTransferCheckout() in comments
  ([12720](https://github.com/civicrm/civicrm-core/pull/12720))**

- **NFC cleanup to Membership/Renewal form classes.
  ([12696](https://github.com/civicrm/civicrm-core/pull/12696))**

- **[CRM-21677](https://issues.civicrm.org/jira/browse/CRM-21677) Report
  improvements ([12703](https://github.com/civicrm/civicrm-core/pull/12703) and
  [12698](https://github.com/civicrm/civicrm-core/pull/12698))**

- **Deduplicate setting of mailSent message
  ([12694](https://github.com/civicrm/civicrm-core/pull/12694))**

- **Setting form - function extraction
  ([12744](https://github.com/civicrm/civicrm-core/pull/12744))**


## <a name="credits"></a>Credits

This release was developed by the following code authors:

AGH Strategies - Alice Frumin, Andrew Hunt; Andrew Thompson; Australian Greens - Seamus Lee; calbasi; Chris Burgess; chriscant; Circle Interactive - Dave Jenkins; CiviCoop - Klaas Eikelboom; CiviCRM - Coleman Watts, Tim Otten; CiviDesk - Yashodha Chaku; CiviFirst - John Kirk; CompuCorp - Vinu Varshith Sekar; Coop SymbioTIC - Mathieu Lutfy; Fuzion - Jitendra Purohit; JMA Consulting - Monish Deb; John Kingsnorth; Joinery - Allen Shaw; kewljuice; Lemniscus - Noah Miller; Lighthouse Design and Consulting - Brian Shaughnessy; Megaphone Technology Consulting - Jon Goldberg; MillerTech - Chamil Wijesooriya; MJW Consulting - Matthew Wire; Pradeep Nayak; Progressive Technology Project - Jamie McClelland; Richard van Oosterhout; selwyntcy; Semper IT - Karin Gerritsen; Third Sector Design - Michael McAndrew; Wikimedia Foundation - Eileen McNaughton

Most authors also reviewed code for this release; in addition, the following
reviewers contributed their comments:

AGH Strategies - Alice Frumin; Agileware - Justin Freeman; Andrew Thompson; Australian Greens - Seamus Lee; calbasi; Circle Interactive - Dave Jenkins; civibot[bot]; civicrm-builder; CiviCRM - Coleman Watts, Tim Otten; CiviDesk - Yashodha Chaku; CiviFirst - John Kirk; Coop SymbioTIC - Mathieu Lutfy; Fuzion - Jitendra Purohit, Peter Davis; JMA Consulting - Joe Murray, Monish Deb; Joinery - Allen Shaw; Lighthouse Design and Consulting - Brian Shaughnessy; Megaphone Technology Consulting - Jon Goldberg; MillerTech - Chamil Wijesooriya; MJW Consulting - Matthew Wire; Oxfam Germany - Thomas Schüttler; Pradeep Nayak; Richard van Oosterhout; Semper IT - Karin Gerritsen; sleewok; Squiffle Consulting - Aidan Saunders; Third Sector Design - Michael McAndrew; Wikimedia Foundation - Eileen McNaughton

## <a name="feedback"></a>Feedback

These release notes are edited by Alice Frumin and Andrew Hunt.  If you'd like
to provide feedback on them, please log in to https://chat.civicrm.org/civicrm
and contact `@agh1`.
