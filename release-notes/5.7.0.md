# CiviCRM 5.7.0

Released November 7, 2018

- **[Synopsis](#synopsis)**
- **[Features](#features)**
- **[Bugs resolved](#bugs)**
- **[Miscellany](#misc)**
- **[Credits](#credits)**
- **[Feedback](#feedback)**

## <a name="synopsis"></a>Synopsis

| *Does this version...?*                                         |         |
|:--------------------------------------------------------------- |:-------:|
| Fix security vulnerabilities?                                   |         |
| Change the database schema?                                     |         |
| Alter the API?                                                  | **yes** |
| Require attention to configuration options?                     |   no    |
| Fix problems installing or upgrading to a previous version?     |   no    |
| Introduce features?                                             | **yes** |
| Fix bugs?                                                       | **yes** |

## <a name="features"></a>Features

### CiviCore

- **Fix api profile.submit to work with tag & note fields
  ([12825](https://github.com/civicrm/civicrm-core/pull/12825))**

  This change improves the api profile.submit so that one can add and remove tags
  via the api and add a note field via the api.

- **Better title for note field
  ([12827](https://github.com/civicrm/civicrm-core/pull/12827))**

  Updates the title of the note field from "note(s)" to "note" because you can
  only import one note at a time.

### CiviMember

- **Convert membership date fields to datepicker & form to entity form
  ([12690](https://github.com/civicrm/civicrm-core/pull/12690))**

  Updates the membership date fields to datepicker (from jcalendar) and form to
  entity form.

### CiviContribute

- **Use cached function for financialAccount retrieval.
  ([12773](https://github.com/civicrm/civicrm-core/pull/12773))**

  This is a Performance improvement which reduces repetitive queries when creating
  Contributions.

- **Allow descriptions for payment fields
  ([12721](https://github.com/civicrm/civicrm-core/pull/12721))**

  This change makes it so one can add a description to a payment field.

### CiviEvent

- **Allow to specify template_id on URL when creating a new event
  ([12781](https://github.com/civicrm/civicrm-core/pull/12781))**

  This change makes it so one can specify a template ID in the URL when creating
  a new event. Example:
  http://example.com/civicrm/event/add?reset=1&action=add&template_id=99

## <a name="bugs"></a>Bugs resolved

### CiviEvent

- **Don't show 'Register Participant' on the manage events page if the logged in
  user does not have 'Edit Event Participants' permission
  ([12768](https://github.com/civicrm/civicrm-core/pull/12768))**

  This change ensures that only users with the permission "Edit Event
  Participants" can view the "Register Participant" link on the manage events
  page.

### CiviMail

- **[dev/core#281](https://lab.civicrm.org/dev/core/issues/281) Fix invoice
  number in message template
  ([12856](https://github.com/civicrm/civicrm-core/pull/12856))**

  This change fixes a bug where when printing or emailing an Invoice the Invoice
  Number field showed the invoice id instead of the human readable invoice id so
  that it shows the human readable invoice id.

- **[dev/core#421](https://lab.civicrm.org/dev/core/issues/421) Creating a new
  message template from within CiviMail interface requires both edit user
  workflow templates and edit system workflow templates as well as edit message
  templates ([12896](https://github.com/civicrm/civicrm-core/pull/12896))**

  This change makes it so to create a new message template from within the
  civimail interface a user must have the permission "edit message templates" and
  the relevant permission (either "edit user workflow templates" or "edit system
  workflow templates"). Prior to this change the user had to have all three
  permissions.

- **Renamed Mailing Component entity
  ([12728](https://github.com/civicrm/civicrm-core/pull/12728))**

  This change renames the Mailing Component entity from CRM/Core/DAO/Component.php
  to CRM/Core/DAO/MailingComponent.php to fix some extension compatibility issues.

- **Regenerate MailingComponent DAO file to reflect recent changes
  ([12877](https://github.com/civicrm/civicrm-core/pull/12877))**

  This change updates the DAO files to reflect the name change from
  CRM/Core/DAO/Component.php to CRM/Core/DAO/MailingComponent.php.

- **[dev/core#410](https://lab.civicrm.org/dev/core/issues/410) Validation
  Problems on Scheduled Reminders Form With SMS
  ([12874](https://github.com/civicrm/civicrm-core/pull/12874))**

  This change cleans up the SMS reminder form to properly denote which fields are
  required and which are optional.

### CiviContribute

- **Add span to amount label in Confirm.tpl
  ([12847](https://github.com/civicrm/civicrm-core/pull/12847))**

  This change adds a html span tag to the amount label on the Contribution Confirm
  page to make it so one can more easily hide labels as needed.

- **When submitting a standalone credit card contribution the contact email
  address should not be deleted
  ([12854](https://github.com/civicrm/civicrm-core/pull/12854))**

  This change fixes a bug where submitting a credit card contribution on the
  backend would result in the email address for the contact being deleted so that
  the email address is not deleted.

- **Remove duplicate payment processor select on Membership Renewal form
  ([12734](https://github.com/civicrm/civicrm-core/pull/12734))**

  This change makes it so when one goes to Renew a membership on the "Renew-Credit
  Card" form the Payment processor selection field only appears once.

### CiviCase

- **[dev/core#370](https://lab.civicrm.org/dev/core/issues/370) No new tasks and
  documents get added to workflow if all built-in ones are deleted
  ([12748](https://github.com/civicrm/civicrm-core/pull/12748))**

  This change makes it so one can delete all built in tasks associated with a case
  type and then add new ones. Before this change if one deleted all existing tasks
  associated with a case type they could not add new ones.

- **Remove Stray Extra Div in Case Dashboard TPL
  ([12848](https://github.com/civicrm/civicrm-core/pull/12848))**

  This change removes an extra div tag on the case dashboard that was messing up
  the layout of the page for some Wordpress users.

### CiviReport

- **[dev/core#396](https://lab.civicrm.org/dev/core/issues/396) date ranges are
  lost when creating smart groups
  ([12909](https://github.com/civicrm/civicrm-core/pull/12909))**

  This change fixes a regression where smart groups created using a manually
  entered date range (the user sets a start and end date as opposed to a preset
  range like "this year") where not respecting the date range entered so that they
  do respect the date range entered.

- **[dev/core#386](https://lab.civicrm.org/dev/core/issues/386) Contribution
  Detail Report shows no amount if set to Soft Credit Only.
  ([12860](https://github.com/civicrm/civicrm-core/pull/12860))**

  This change fixes a bug where, on the Contribution Detail Report, if the report
  was configured to show only  Soft Credit amounts the Amount column would display
  as empty, so that it displays soft credit amounts as expected.

- **[dev/core#376](https://lab.civicrm.org/dev/core/issues/376) Contact Detail
  report breaks when adding clause using selectWhereClause()
  ([12772](https://github.com/civicrm/civicrm-core/pull/12772))**

  This change fixes a bug where the selectWhereClause() hook was breaking when
  trying to add a clause to the contact table on the Contact Detail Report.

- **closes reporting#6 - can't sort by Street Name
  ([12808](https://github.com/civicrm/civicrm-core/pull/12808))**

  This change fixes a bug where for reports that use the common function to get
  address fields one could not sort by the "street name" field.

### Core CiviCRM

- **Fix invalid markup on extension page - remove dots from ids & classes
  ([12882](https://github.com/civicrm/civicrm-core/pull/12882))**

  This change fixes markup on the extensions page by removing dots from the ids
  and classes.

- **Don't mess up fragment links in nav menu
  ([12876](https://github.com/civicrm/civicrm-core/pull/12876))**

  Fixes a bug where where fragment links (for example, javascript-oriented links
  like <a href="#summary">) were not rendering properly in the navigation menu.

- **(DX) Civi::contactSettings - Add a facade for working with the logged-in
  user's settings
  ([12879](https://github.com/civicrm/civicrm-core/pull/12879))**

  Creates a new facade for working with the logged-in user's settings.
  Specifically makes it possible for developers to use a snippet like `$myFilter =
  Civi::contactSettings()->get('activity_tab_filter');`.

- **Add icons to top-level navigation menu
  ([12878](https://github.com/civicrm/civicrm-core/pull/12878))**

  Adds icons to the top level CiviCRM navigation menu.

- **[dev/core#362](https://lab.civicrm.org/dev/core/issues/362) Contact Refence
  Fields don't allow search and select On Behalf Profiles
  ([12790](https://github.com/civicrm/civicrm-core/pull/12790))**

  This change fixes a bug where the search and select functionality for Contact
  Reference fields in On Behalf profiles was breaking so that the search and
  select functionality for Contact Reference fields in On Behalf profiles
  functions as expected.

- **Freeze custom data elements when viewing an entity
  ([12867](https://github.com/civicrm/civicrm-core/pull/12867))**

   This change fixes a bug where when viewing an entity loaded via AJAX with
   custom data the custom data was editable so that it is not editable in view
   mode.

- **Improve display of relationships tab
  ([12800](https://github.com/civicrm/civicrm-core/pull/12800))**

  This change makes the markup on the relationships tab more consistent with the
  rest of civi so that it displays correctly and the help text is cleaner.

- **[dev/core#393](https://lab.civicrm.org/dev/core/issues/393) OptionGroup
  check doesn't like option values of zero in a group of integers
  ([12817](https://github.com/civicrm/civicrm-core/pull/12817))**

  This change makes it so one can create an option group with a data type of
  "Integer" and an option value of "0". before this change a notice would be
  thrown when trying to create an option value with a value of "0".

- **SHOR-16: Fixed spacing between & table structure issues
  ([12811](https://github.com/civicrm/civicrm-core/pull/12811))**

  This change cleans up the layout (spacing and table structure) on events &
  membership pages.

- **SHOR-17: Fixed pages dropdown design issues
  ([12812](https://github.com/civicrm/civicrm-core/pull/12812))**

  This change cleans up the layout on Campaign pages.

- **[dev/core#379](https://lab.civicrm.org/dev/core/issues/379) View Activity:
   extraneous newlines by nl2br on HTML content
  ([12778](https://github.com/civicrm/civicrm-core/pull/12778))**

  This change fixes a bug where in the details field on an activity extra
  spacing was being added.

- **Display tables correctly on import wizard/membership dashboard when using
  drupal bootstrap based theme
  ([12799](https://github.com/civicrm/civicrm-core/pull/12799))**

  This change fixes the display of tables on the import wizard and the
  membership dashboard for sites that use a drupal bootstrap based theme.

- **[dev/core#382](https://lab.civicrm.org/dev/core/issues/382) DB Error
  generated when updating a group with an organisation record attached where the
  id in the civicrm_group_organisation does not match the id in civicrm_group
  ([12785](https://github.com/civicrm/civicrm-core/pull/12785))**

  This change fixes a bug where when updating a group linked to an organization
  where the record id in the civicrm_group_organization table did not match the
  groupId a db error was being thrown.

- **Fix capitalisation for 'Republic of' countries (Iran, Macedonia)
  ([12802](https://github.com/civicrm/civicrm-core/pull/12802))**

  This change fixes "Republic of" countries (like Iran and Macedonia) so that
  the "of" is not capitalized.

- **fixing batch search by payment method
  ([12707](https://github.com/civicrm/civicrm-core/pull/12707))**

  This change fixes a bug where searching an accounting batch by payment method
  was not respecting the payment method search parameter so that the payment
  method search parameter is respected.

## <a name="misc"></a>Miscellany

- **Rename variable in MembershipRenewal form to make a merge with Membership
  form in future easier
  ([12798](https://github.com/civicrm/civicrm-core/pull/12798))**

- **Report Template test for SelectWhere - add test
  ([12809](https://github.com/civicrm/civicrm-core/pull/12809))**

- **Alter Test to ensure that order of city is output doesn't mater in th…
  ([12815](https://github.com/civicrm/civicrm-core/pull/12815))**

- **5.7 ([12894](https://github.com/civicrm/civicrm-core/pull/12894))**

- **5.6.0 release notes
  ([12816](https://github.com/civicrm/civicrm-core/pull/12816))**

- **5.6 to master
  ([12814](https://github.com/civicrm/civicrm-core/pull/12814))**

- **Just a test. ([12794](https://github.com/civicrm/civicrm-core/pull/12794))**

- **NFC: Rename variable in RecurringEntityPreview
  ([12770](https://github.com/civicrm/civicrm-core/pull/12770))**

- **5.6 to Master
  ([12840](https://github.com/civicrm/civicrm-core/pull/12840))**

- **NFC: fix grammar/punctuation in help
  ([12838](https://github.com/civicrm/civicrm-core/pull/12838))**

- **5.6 ([12835](https://github.com/civicrm/civicrm-core/pull/12835))**

- **[NFC] Add unit test to cover component ACLs.
  ([12846](https://github.com/civicrm/civicrm-core/pull/12846))**

- **5.6 to Master
  ([12852](https://github.com/civicrm/civicrm-core/pull/12852))**

- **5.6 ([12850](https://github.com/civicrm/civicrm-core/pull/12850))**

- **NFC Fix overindenting in caseDashboard template
  ([12853](https://github.com/civicrm/civicrm-core/pull/12853))**

- **(NFC) Fix indenting of Case DashBoard.tpl
  ([12849](https://github.com/civicrm/civicrm-core/pull/12849))**

- **Fix typo ([12858](https://github.com/civicrm/civicrm-core/pull/12858))**

- **Merge 5.6 to master
  ([12871](https://github.com/civicrm/civicrm-core/pull/12871))**

- **5.6 ([12865](https://github.com/civicrm/civicrm-core/pull/12865))**

- **5.6 to master
  ([12863](https://github.com/civicrm/civicrm-core/pull/12863))**

- **[CRM-21677](https://issues.civicrm.org/jira/browse/CRM-21677) Report
  improvements ([12885](https://github.com/civicrm/civicrm-core/pull/12885))**

- **Export code improvement
  ([12672](https://github.com/civicrm/civicrm-core/pull/12672))**

- **Cleanup pledge form to use datepicker
  ([12774](https://github.com/civicrm/civicrm-core/pull/12774))**

- **SHOR-10: Fixed wrapper
  ([12820](https://github.com/civicrm/civicrm-core/pull/12820))**

- **Add new paymentprocessor supportsX methods to replace remaining isSupported
  methods ([12762](https://github.com/civicrm/civicrm-core/pull/12762))**

- **Convert "Info and Settings" tab on ManageEvent to use datepicker
  ([12776](https://github.com/civicrm/civicrm-core/pull/12776))**

- **Switch grant form to use crmDatepicker instead of jCalendar
  ([12771](https://github.com/civicrm/civicrm-core/pull/12771))**

- **Convert RecurringEntity form to datepicker
  ([12746](https://github.com/civicrm/civicrm-core/pull/12746))**

## <a name="credits"></a>Credits

This release was developed by the following code authors:

AGH Strategies - Alice Frumin, Andrew Hunt; Australian Greens - Seamus Lee; CiviCRM - Coleman Watts, Tim Otten; CiviDesk - Yashodha Chaku; CompuCorp - Mukesh Ram; Coop SymbioTIC - Mathieu Lutfy; JMA Consulting - Joe Murray; Lemniscus - Noah Miller; Megaphone Technology Consulting - Jon Goldberg; MJW Consulting - Matthew Wire; mmyriam; Pradeep Nayak; Progressive Technology Project - Jamie McClelland; Samson Alajede; Tadpole Collective - Kevin Cristiano; Tanya Bouman; Team Expansion - Greg Harris; Wikimedia Foundation - Eileen McNaughton

Most authors also reviewed code for this release; in addition, the following
reviewers contributed their comments:

AGH Strategies - Alice Frumin, Andrew Hunt; Australian Greens - Seamus Lee; Circle Interactive - Dave Jenkins; civibot[bot]; civicrm-builder; CiviCRM - Coleman Watts, Tim Otten; CiviDesk - Yashodha Chaku; CompuCorp - Mukesh Ram; Coop SymbioTIC - Mathieu Lutfy; Digitalcourage - Detlev Sieber; JMA Consulting - Monish Deb; Joinery - Allen Shaw; Megaphone Technology Consulting - Jon Goldberg; MJW Consulting - Matthew Wire; Pradeep Nayak; Tadpole Collective - Kevin Cristiano; Tanya Bouman; Wikimedia Foundation - Eileen McNaughton

## <a name="feedback"></a>Feedback

These release notes are edited by Alice Frumin and Andrew Hunt.  If you'd like
to provide feedback on them, please log in to https://chat.civicrm.org/civicrm
and contact `@agh1`.
