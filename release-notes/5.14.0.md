# CiviCRM 5.14.0

Released June 5, 2019

- **[Synopsis](#synopsis)**
- **[Features](#features)**
- **[Bugs resolved](#bugs)**
- **[Miscellany](#misc)**
- **[Credits](#credits)**
- **[Feedback](#feedback)**

## <a name="synopsis"></a>Synopsis

| *Does this version...?*                                         |         |
|:--------------------------------------------------------------- |:-------:|
| Fix security vulnerabilities?                                   |         |
| Change the database schema?                                     |         |
| Alter the API?                                                  |         |
| Require attention to configuration options?                     |         |
| Fix problems installing or upgrading to a previous version?     |         |
| Introduce features?                                             |         |
| Fix bugs?                                                       |         |

## <a name="features"></a>Features

### Drupal Integration

- **Drupal Views : relationships for standard groups
  ([CRM-20006](https://issues.civicrm.org/jira/browse/CRM-20006):
  [507](https://github.com/civicrm/civicrm-drupal/pull/507))**

  Adds relationships for standard groups to the CiviCRM/Drupal Views
  integration.

### Core CiviCRM

## <a name="bugs"></a>Bugs resolved

### CiviMail

### Core CiviCRM

- **Email processor filing all emails as .unknown attachments
  ([dev/core#940](https://lab.civicrm.org/dev/core/issues/940):
  [14208](https://github.com/civicrm/civicrm-core/pull/14208))**

  Fixes a regression where emails being sent to the e-mail-to-activity-Mailbox
  were being saved with a `.unknown` extension and no content.

- **Regression - faster activity tab in 5.13 won't sort by source_name now
  ([dev/core#934](https://lab.civicrm.org/dev/core/issues/934):
  [14194](https://github.com/civicrm/civicrm-core/pull/14194) and
  [14204](https://github.com/civicrm/civicrm-core/pull/14204))**

  Fixes a regression in core where the activity tab could not be sorted by
  `source_name` so that the activity tab can be sorted by `source_name`.

- **Civi 5.13.0 fails to upgrade on multilingual sites ([dev/core#931](https://lab.civicrm.org/dev/core/issues/931): [14188](https://github.com/civicrm/civicrm-core/pull/14188))**

- **Error randomly appearing when Financial type ACL is enanled ([dev/core#918](https://lab.civicrm.org/dev/core/issues/918): [14165](https://github.com/civicrm/civicrm-core/pull/14165) and [14168](https://github.com/civicrm/civicrm-core/pull/14168))**

- **Membership status processor ignoring records where is_override=0 ([dev/core#881](https://lab.civicrm.org/dev/core/issues/881): [14073](https://github.com/civicrm/civicrm-core/pull/14073))**

- **utf8mb4 warning keeps coming back up ([dev/core#880](https://lab.civicrm.org/dev/core/issues/880): [14123](https://github.com/civicrm/civicrm-core/pull/14123))**

- **Allow url to set IS NULL/ NOT NULL in report for operations ([dev/core#876](https://lab.civicrm.org/dev/core/issues/876): [14052](https://github.com/civicrm/civicrm-core/pull/14052))**

- **Mosaico A/B testing for "Subject" line ([dev/core#873](https://lab.civicrm.org/dev/core/issues/873): [14047](https://github.com/civicrm/civicrm-core/pull/14047) and [14044](https://github.com/civicrm/civicrm-core/pull/14044))**

- **Result filter criteria doesn't show IS NULL/IS NOT NULL for operations ([dev/core#865](https://lab.civicrm.org/dev/core/issues/865): [14028](https://github.com/civicrm/civicrm-core/pull/14028))**

- **Dedupe fails on address field in 5.12 ([dev/core#859](https://lab.civicrm.org/dev/core/issues/859): [14034](https://github.com/civicrm/civicrm-core/pull/14034))**

- **CQ: Refactor Recurring Contribution Forms ([dev/core#846](https://lab.civicrm.org/dev/core/issues/846): [13994](https://github.com/civicrm/civicrm-core/pull/13994) and [13993](https://github.com/civicrm/civicrm-core/pull/13993))**

- **Long running sql queries from CiviCase ([dev/core#832](https://lab.civicrm.org/dev/core/issues/832): [14139](https://github.com/civicrm/civicrm-core/pull/14139))**

- **Proposal - add cancel_reason field to civicrm_contribution_recur table ([dev/core#830](https://lab.civicrm.org/dev/core/issues/830): [14119](https://github.com/civicrm/civicrm-core/pull/14119))**

- **CQ: Switch core forms to be Entity Forms ([dev/core#818](https://lab.civicrm.org/dev/core/issues/818): [13887](https://github.com/civicrm/civicrm-core/pull/13887))**

- **File custom fields cause a fatal error when trying to merge ([dev/core#723](https://lab.civicrm.org/dev/core/issues/723): [14144](https://github.com/civicrm/civicrm-core/pull/14144) and [14146](https://github.com/civicrm/civicrm-core/pull/14146))**

- **Remove instances of $dao->free ([dev/core#562](https://lab.civicrm.org/dev/core/issues/562): [14070](https://github.com/civicrm/civicrm-core/pull/14070), [14071](https://github.com/civicrm/civicrm-core/pull/14071) and [14037](https://github.com/civicrm/civicrm-core/pull/14037))**

- **Replace jcalendar instances with datepicker ([dev/core#561](https://lab.civicrm.org/dev/core/issues/561): [14150](https://github.com/civicrm/civicrm-core/pull/14150))**

- **Replace all instances of CRM_Core_Fatal with throw new CRM_Core_Exception ([dev/core#560](https://lab.civicrm.org/dev/core/issues/560): [14143](https://github.com/civicrm/civicrm-core/pull/14143))**

- **CRM-18570 When creating a new event using a template the new event screen is taking the default values directly from the custom fields, and not from what's saved in the event template. ([dev/core#553](https://lab.civicrm.org/dev/core/issues/553): [14063](https://github.com/civicrm/civicrm-core/pull/14063))**

- **Batch update membership type ([dev/core#338](https://lab.civicrm.org/dev/core/issues/338): [14064](https://github.com/civicrm/civicrm-core/pull/14064))**

- **Advanced Search - Mailing column headers out of alignment ([dev/core#248](https://lab.civicrm.org/dev/core/issues/248): [14134](https://github.com/civicrm/civicrm-core/pull/14134))**

- **Civi 5.12.1 renders Quicksearch unreadable on Drupal 8 ([dev/drupal#56](https://lab.civicrm.org/dev/drupal/issues/56): [14080](https://github.com/civicrm/civicrm-core/pull/14080))**

- **Back-office membership renewals don't display an on-screen notification ([dev/membership#9](https://lab.civicrm.org/dev/membership/issues/9): [14088](https://github.com/civicrm/civicrm-core/pull/14088))**

- **On PHP 7.2 we cannot start session until it has been configured by Dr… ([14193](https://github.com/civicrm/civicrm-core/pull/14193))**

- **Hook to alter menubar css variables & fix breakpoint in WP ([14135](https://github.com/civicrm/civicrm-core/pull/14135))**

- **Event Cart: pass the contactID to fix payment on Stripe ([14173](https://github.com/civicrm/civicrm-core/pull/14173))**

- **Event Cart: fix sending of email receipts ([14170](https://github.com/civicrm/civicrm-core/pull/14170))**

- **Event Cart: add support for the Credit Card type icons ([14175](https://github.com/civicrm/civicrm-core/pull/14175))**

- **Event Cart: honor the allow_same_participant_emails setting ([14174](https://github.com/civicrm/civicrm-core/pull/14174))**

- **Event Cart: fix start_date formatting in line items during checkout ([14169](https://github.com/civicrm/civicrm-core/pull/14169))**

- **Convert dedupe select to select 2 and remove not-used var ([14161](https://github.com/civicrm/civicrm-core/pull/14161))**

- **Fixed double protocol being added in link by CKEditor. ([14128](https://github.com/civicrm/civicrm-core/pull/14128))**

- **Case activity query performs poorly on large databases ([14086](https://github.com/civicrm/civicrm-core/pull/14086))**

- **Call Payment.create from payment.cancel ([13689](https://github.com/civicrm/civicrm-core/pull/13689))**

- **Add function filterLinks to return an array of links for an entity that can be used by the API / form layer to generate a link ([14112](https://github.com/civicrm/civicrm-core/pull/14112))**

- **Fix import primary phone, primary email, add tests ([14043](https://github.com/civicrm/civicrm-core/pull/14043))**

- **Fix ts() usage in CRM_SMS_Form_Schedule ([14111](https://github.com/civicrm/civicrm-core/pull/14111))**

- **Convert Pledge Calander Date and Start Date for pledges to use datepic… ([14099](https://github.com/civicrm/civicrm-core/pull/14099))**

- **Fix bug preventing affecting `cv --user` on Joomla ([13890](https://github.com/civicrm/civicrm-core/pull/13890))**

- **Add serialize metadata to tag used_for field ([14096](https://github.com/civicrm/civicrm-core/pull/14096))**

- **Fix upgrade message db setting location ([14083](https://github.com/civicrm/civicrm-core/pull/14083))**

- **change is_override logic ([14059](https://github.com/civicrm/civicrm-core/pull/14059))**

- **Fixed auto populate of contact refrence field on membership signup form ([14077](https://github.com/civicrm/civicrm-core/pull/14077))**

- **Cron Status Check - Better hyperlinks ([14085](https://github.com/civicrm/civicrm-core/pull/14085))**

- **fix getAddressColumns() to respect tableAlias ([14014](https://github.com/civicrm/civicrm-core/pull/14014))**

- **Update mastercard icon to match branding guidelines ([14078](https://github.com/civicrm/civicrm-core/pull/14078))**

- **Make DAO fields more consistent ([14072](https://github.com/civicrm/civicrm-core/pull/14072))**

- **Ensure edit tooltip is always initially hidden in contact summary block ([14065](https://github.com/civicrm/civicrm-core/pull/14065))**

- **Skip adding core resources when building assets ([14010](https://github.com/civicrm/civicrm-core/pull/14010))**

- **Switch to using ContributionRecur.cancel api from CancelSubscription form ([14033](https://github.com/civicrm/civicrm-core/pull/14033))**

- **Make hook_civicrm_pre() and hook_civicrm_post() fire on CaseContacts ([14030](https://github.com/civicrm/civicrm-core/pull/14030))**

- **Create contribution before taking payment, per contribution page workflow ([13837](https://github.com/civicrm/civicrm-core/pull/13837))**

- **Add pseudoconstant to UFField dao ([14041](https://github.com/civicrm/civicrm-core/pull/14041))**

- **Bump php version to match core requirements ([567](https://github.com/civicrm/civicrm-drupal/pull/567))**

- **Enable contribution views to filter on empty Receipt and Thank You dates ([573](https://github.com/civicrm/civicrm-drupal/pull/573))**

- **Don't render an empty mailto link for empty email addresses ([540](https://github.com/civicrm/civicrm-drupal/pull/540))**

- **Issue 48: make it next_sched_contribution_date ([578](https://github.com/civicrm/civicrm-drupal/pull/578))**

## <a name="misc"></a>Miscellany

- **(NFC) Add tests of retreiving notes for display on a contact record a…
  ([14094](https://github.com/civicrm/civicrm-core/pull/14094))**

- **(NFC) Update CRM/Contact to match new coder style
  ([14022](https://github.com/civicrm/civicrm-core/pull/14022))**

- **(NFC) Minor code style fixes
  ([14015](https://github.com/civicrm/civicrm-core/pull/14015))**

- **(NFC) Add in unit test checking that E2E test returns sensible contac…
  ([14076](https://github.com/civicrm/civicrm-core/pull/14076))**

- **NFC Whitespace formatting for formButtons.tpl
  ([14107](https://github.com/civicrm/civicrm-core/pull/14107))**

- **(NFC) Expand unit test to show off double protocol error
  ([14141](https://github.com/civicrm/civicrm-core/pull/14141))**

- ** [REF] move gathering of location info to relevant function (towards
  dev/core#723) ([14142](https://github.com/civicrm/civicrm-core/pull/14142))**

- **[REF] Move the qfbug handling to it's own function (towards dev/core#723)
  ([14140](https://github.com/civicrm/civicrm-core/pull/14140))**

- **[REF] Use events for CMS resource loading
  ([14131](https://github.com/civicrm/civicrm-core/pull/14131))**

- **[REF] extract getConflicts function
  ([14148](https://github.com/civicrm/civicrm-core/pull/14148))**

- **[REF] Extract get cfields function
  ([14151](https://github.com/civicrm/civicrm-core/pull/14151))**

- **[REF] Use variable for menubar height
  ([14122](https://github.com/civicrm/civicrm-core/pull/14122))**

- **[REF] Clean up CRM_Contribute_Form_SearchTest
  ([14068](https://github.com/civicrm/civicrm-core/pull/14068))**

- **[REF] Extract formatLocationBlock from import parsing
  ([14040](https://github.com/civicrm/civicrm-core/pull/14040))**

- **[REF] function extraction in dedupe code
  ([14157](https://github.com/civicrm/civicrm-core/pull/14157))**

- **[REF] cleanup input parameters on extracted function
  ([14050](https://github.com/civicrm/civicrm-core/pull/14050))**

- **(REF) Fix accepted params in CustomValueTable::setValues
  ([14079](https://github.com/civicrm/civicrm-core/pull/14079))**

- **(REF) Fix unnecessary required param in contact BAO update
  ([14075](https://github.com/civicrm/civicrm-core/pull/14075))**

- **(REF) Reduce redundant code in CRM_Utils_Type::validate
  ([14011](https://github.com/civicrm/civicrm-core/pull/14011))**

- **REF Replace hardcoded IDs with pseudoconstants in activity form
  ([14108](https://github.com/civicrm/civicrm-core/pull/14108))**

- **(REF) Standardize UFField create function
  ([14084](https://github.com/civicrm/civicrm-core/pull/14084))**

- ** [REF] calll formatLocationBlock from parent function.
  ([14105](https://github.com/civicrm/civicrm-core/pull/14105))**

- **(REF; dev/core#873) MailingAB - Migrate "copy winner" logic from JS to PHP
  ([14045](https://github.com/civicrm/civicrm-core/pull/14045))**

- **REF Don't pass activity object to addCaseActivityLinks
  ([14110](https://github.com/civicrm/civicrm-core/pull/14110))**

- **REF Use shared function to check inbound email permissions
  ([14109](https://github.com/civicrm/civicrm-core/pull/14109))**

- **[REF] Follow up tidy up on import fixes
  ([14117](https://github.com/civicrm/civicrm-core/pull/14117))**

- **Readability cleanup on EventIncome report (towards bringing it under
  testing) ([13963](https://github.com/civicrm/civicrm-core/pull/13963))**

- **Remove deprecated function
  ([14039](https://github.com/civicrm/civicrm-core/pull/14039))**

- **Revert "dev/core#553: Creating new event takes value from default value not
  from saved template for custom fields"
  ([14121](https://github.com/civicrm/civicrm-core/pull/14121))**

- **Update docblock for doPayment function
  ([13844](https://github.com/civicrm/civicrm-core/pull/13844))**

- **[cleanup] remove CRM_Report_Form_Extended
  ([14149](https://github.com/civicrm/civicrm-core/pull/14149))**

## <a name="credits"></a>Credits

This release was developed by the following code authors:

AGH Strategies - Alice Frumin, Andrew Hunt; Agileware - Alok Patel; Australian
Greens - Seamus Lee; Christian Wach; CiviCRM - Coleman Watts, Tim Otten;
CiviDesk - Yashodha Chaku; Coop SymbioTIC - Mathieu Lutfy; Dave D; Electronic
Frontier Foundation - Mark Burdett; Freeform Solutions - Herb van den Dool;
Fuzion - Luke Stewart; Guillaume Rischard; JMA Consulting - Monish Deb; John
Kingsnorth; Korlon - Stuart Gaston; Lighthouse Design and Consulting - Brian
Shaughnessy; Megaphone Technology Consulting - Jon Goldberg; MJW Consulting -
Matthew Wire; Pradeep Nayak; Squiffle Consulting - Aidan Saunders; Tadpole
Collective - Kevin Cristiano; Wikimedia Foundation - Eileen McNaughton

Most authors also reviewed code for this release; in addition, the following
reviewers contributed their comments:

CiviCRM - Coleman Watts, Tim Otten; DevApp - Adam Kwiatkowski; Fuzion - Jitendra
Purohit; JMA Consulting - Joe Murray; Nicol Wistreich; Palante - Morgan
Robinson; Skvare - Mark Hanna; tapashdatta;

## <a name="feedback"></a>Feedback

These release notes are edited by Alice Frumin and Andrew Hunt.  If you'd like
to provide feedback on them, please log in to https://chat.civicrm.org/civicrm
and contact `@agh1`.
