# CiviCRM 5.8.0

Released December 5, 2018

- **[Synopsis](#synopsis)**
- **[Features](#features)**
- **[Bugs resolved](#bugs)**
- **[Miscellany](#misc)**
- **[Credits](#credits)**
- **[Feedback](#feedback)**

## <a name="synopsis"></a>Synopsis

| *Does this version...?*                                         |         |
|:--------------------------------------------------------------- |:-------:|
| Fix security vulnerabilities?                                   |         |
| Change the database schema?                                     |         |
| Alter the API?                                                  |         |
| Require attention to configuration options?                     |         |
| Fix problems installing or upgrading to a previous version?     |         |
| Introduce features?                                             |         |
| Fix bugs?                                                       |         |

## <a name="features"></a>Features

- **Configurable quicksearch settings - this permits (some) custom fields to be added to quicksearch as searchable fields ([13039](https://github.com/civicrm/civicrm-core/pull/13039)) and [13056](https://github.com/civicrm/civicrm-core/pull/13056))**

- **Support a greater range of date options for relative searches (e.g last 45 days, last 18 months) requires option values to be added by an extension or by an experienced admin, limited UI ([12682](https://github.com/civicrm/civicrm-core/pull/12682))**

- **Allow contribution search by recurring payment processor ID / Transaction ID ([12818](https://github.com/civicrm/civicrm-core/pull/12818))**

- **dev/core/495 Introduce generic settings form (fully metadata driven) - this provides a supported methodology for extensions to add settings forms and to alter core settings forms (albeit not all core forms are converted to that point).([13054](https://github.com/civicrm/civicrm-core/pull/13054)) and ([13062](https://github.com/civicrm/civicrm-core/pull/13062)) and ([13047](https://github.com/civicrm/civicrm-core/pull/13047)) and ([13046](https://github.com/civicrm/civicrm-core/pull/13046)) and ([13048](https://github.com/civicrm/civicrm-core/pull/13048)) and ([13040](https://github.com/civicrm/civicrm-core/pull/13040)) and ([13004](https://github.com/civicrm/civicrm-core/pull/13004)) and ([13026](https://github.com/civicrm/civicrm-core/pull/13026)) and ([13027](https://github.com/civicrm/civicrm-core/pull/13027)) and ([13025](https://github.com/civicrm/civicrm-core/pull/13025)) and ([12731](https://github.com/civicrm/civicrm-core/pull/12731)) and  ([12940](https://github.com/civicrm/civicrm-core/pull/12940)) and ([13022](https://github.com/civicrm/civicrm-core/pull/13022)) and ([13023](https://github.com/civicrm/civicrm-core/pull/13023) and ([12906](https://github.com/civicrm/civicrm-core/pull/12906)) and ([12919](https://github.com/civicrm/civicrm-core/pull/12919)) and ([12925](https://github.com/civicrm/civicrm-core/pull/12925)) and ([12960](https://github.com/civicrm/civicrm-core/pull/12960))**

- **Add icons to contact summary tabs ([13018](https://github.com/civicrm/civicrm-core/pull/13018))**

- **Closes core#477 - display employer/title/group info in print summary ([13030](https://github.com/civicrm/civicrm-core/pull/13030))**

- **Extract selectedChild tabheader functionality and enable for Manage Events, extensions, groups. This takes the existing functionaly of adding selectedChild= to a url for a tabbed page and makes it work across all the pages tabs. The tab will have an id of 'tab-x' where x is the thing to use after '=' ([12747](https://github.com/civicrm/civicrm-core/pull/12747))**

- **Adding [CiviMail Draft] on test mailing (for mosaico) ([12758](https://github.com/civicrm/civicrm-core/pull/12758))**

- **Add validate api action for ContributionPage.submit ([12829](https://github.com/civicrm/civicrm-core/pull/12829))**

### CiviReport
- **On reports make current employer available as a field for display ([12904](https://github.com/civicrm/civicrm-core/pull/12904))**

## <a name="bugs"></a>Bugs resolved

### CiviReport

- **[CRM-21677](https://issues.civicrm.org/jira/browse/CRM-21677) Report code style improvements (no user impact) ([13028](https://github.com/civicrm/civicrm-core/pull/13028), [12922](https://github.com/civicrm/civicrm-core/pull/12922), [12916](https://github.com/civicrm/civicrm-core/pull/12916), and [12892](https://github.com/civicrm/civicrm-core/pull/12892))**

- **(dev/core#491) Report results don't show inactive campaigns ([13036](https://github.com/civicrm/civicrm-core/pull/13036))**

- **(dev/core#479) Contribution Summary report throw DB error with custom… ([13017](https://github.com/civicrm/civicrm-core/pull/13017))**

- **Disable ONLY_FULL_GROUP_BY sql mode when doing add2group function on … ([12966](https://github.com/civicrm/civicrm-core/pull/12966))**

### Core CiviCRM

- **Support CiviTutorial - Fix isAjaxMode to also recognize angular ajax ([12921](https://github.com/civicrm/civicrm-core/pull/12921))**

- **dev/core#119 Fix undefined variable notice when going to pages like … ([13063](https://github.com/civicrm/civicrm-core/pull/13063))**

- **PHP 7.3 support (Fix misplaced hyphens in regex) ([13064](https://github.com/civicrm/civicrm-core/pull/13064))**

- **Problem with Custom Field in Contact Reports ([13044](https://github.com/civicrm/civicrm-core/pull/13044))**

- **Fix search performance issues and reliability on some characters issues by removing lower case double-conversion ([12494](https://github.com/civicrm/civicrm-core/pull/12494)) and ([13035](https://github.com/civicrm/civicrm-core/pull/13035)) and ([13034](https://github.com/civicrm/civicrm-core/pull/13034)) and ([12993](https://github.com/civicrm/civicrm-core/pull/12993)) and ([12987](https://github.com/civicrm/civicrm-core/pull/12987)) and ([12988](https://github.com/civicrm/civicrm-core/pull/12988)) and ([12991](https://github.com/civicrm/civicrm-core/pull/12991)) and ([13053](https://github.com/civicrm/civicrm-core/pull/13053)) and ([13055](https://github.com/civicrm/civicrm-core/pull/13055))**

- **dev/core#6 Add in help text about the is public setting for custom groups… ([13060](https://github.com/civicrm/civicrm-core/pull/13060))**

- **[dev/core/287](https://lab.civicrm.org/dev/core/issues/287) Disable child groups if all parents are disabled ([12797](https://github.com/civicrm/civicrm-core/pull/12797)) and ([13061](https://github.com/civicrm/civicrm-core/pull/13061))**

- **Prevent hard error when a string is too long for a field. ([13014](https://github.com/civicrm/civicrm-core/pull/13014))**

- **Mark event start date as required and refactoring ([13049](https://github.com/civicrm/civicrm-core/pull/13049))**

- **Pass path through rawurlencode when not using CIVICRM_CLEANURL ([13043](https://github.com/civicrm/civicrm-core/pull/13043))**

- **Fix custom Home URL parsing ([13031](https://github.com/civicrm/civicrm-core/pull/13031))**

- **Fix caching issues with Event permissions ([12769](https://github.com/civicrm/civicrm-core/pull/12769))**

- **dev/core#456 Improve UX of scheduling mass SMS ([13001](https://github.com/civicrm/civicrm-core/pull/13001))**

- **dev/core#463 Add in ability for Extensions to use their Extension Utils class to s… ([12986](https://github.com/civicrm/civicrm-core/pull/12986))**

- **Duplicate upgrade step for 5.7.beta1 in 5.8.alpha1 to capture anyone … ([13033](https://github.com/civicrm/civicrm-core/pull/13033))**

- **Continue ongoing work to replace jcalendar with datepicker widget - event search form search to datepicker and cleanup template ([12978](https://github.com/civicrm/civicrm-core/pull/12978)) and participant registration form ([12979](https://github.com/civicrm/civicrm-core/pull/12979)) and manage events fees page ([12977](https://github.com/civicrm/civicrm-core/pull/12977)) and manage events registration page ([12975](https://github.com/civicrm/civicrm-core/pull/12975)) and relationship form ([12972](https://github.com/civicrm/civicrm-core/pull/12972)) and event fees page ([12992](https://github.com/civicrm/civicrm-core/pull/12992)) and Update subscription form ([12868](https://github.com/civicrm/civicrm-core/pull/12868))***


- **dev/core#481 Ensure that Bulk Mailings is a checkbox rather than radi… ([13019](https://github.com/civicrm/civicrm-core/pull/13019))**

- **dev/core#472 Allow for APIv3 to find examples in Extension folders as … ([13006](https://github.com/civicrm/civicrm-core/pull/13006))**

- **Activities can be linked to multiple cases. Handle caseIds being an array ([13021](https://github.com/civicrm/civicrm-core/pull/13021))**

- **Style improvement of radio form elements ([12736](https://github.com/civicrm/civicrm-core/pull/12736))**

- **Fix Activity api to cope with renamed record type labels (e.g renaming 'Target' to 'Directed At') ([13008](https://github.com/civicrm/civicrm-core/pull/13008))**

- **dev/core#474 - Show missing log table warning only if logging is enabled ([13010](https://github.com/civicrm/civicrm-core/pull/13010))**

- **Use description from schema if available when using entityForm ([12971](https://github.com/civicrm/civicrm-core/pull/12971))**

- **Translate description in DAO files ([13005](https://github.com/civicrm/civicrm-core/pull/13005))**

- **Replace translation and calendar image icons ([13003](https://github.com/civicrm/civicrm-core/pull/13003))**

- **[dev/core#457] Add $ids to hook_civicrm_export ([12957](https://github.com/civicrm/civicrm-core/pull/12957))**

- **[CRM-21311](https://issues.civicrm.org/jira/browse/CRM-21311) Fix CIVICRM-668 Credit card type is unset on submission causing credit card payment to fail with CVV validation error message ([12615](https://github.com/civicrm/civicrm-core/pull/12615))**

- **Added relationship active filter in CiviCRM Case reports. ([12711](https://github.com/civicrm/civicrm-core/pull/12711))**

- **(NFC) Fix Namespace issue in Api3DocTrait when calling smarty ([13007](https://github.com/civicrm/civicrm-core/pull/13007))**

- **dev/financial#33 Add in Hook postIPNProcess to allow Extensions to do c… ([12928](https://github.com/civicrm/civicrm-core/pull/12928))**

- **api bug - Fix mishandling of mixed case strings in some api requests on custom values([12930](https://github.com/civicrm/civicrm-core/pull/12930))**

- **dev/core#461 - Duplicate Message template is generated when it is sav… ([12982](https://github.com/civicrm/civicrm-core/pull/12982))**

- **dev/translation#15 Fix backend CC contributions left pending if statuses are localised ([12999](https://github.com/civicrm/civicrm-core/pull/12999))**

- **Don't format date twice for RecurringEntity form ([12974](https://github.com/civicrm/civicrm-core/pull/12974))**

- **Add ts to untranslated string ([12989](https://github.com/civicrm/civicrm-core/pull/12989))**

- **Fix "crmURL" parameters in various templates ([12968](https://github.com/civicrm/civicrm-core/pull/12968))**

- **CRM_Core_Resources - Allow container to swap the implementation ([12959](https://github.com/civicrm/civicrm-core/pull/12959))**

- **[dev/core#412] Avoid truncated UTF-8 strings when using substr() ([12935](https://github.com/civicrm/civicrm-core/pull/12935))**

- **PHP 7.1 bugfix: undeclared array subdimension with batch CSV export ([12946](https://github.com/civicrm/civicrm-core/pull/12946))**

- **dev/core#448 Fix issue where when building mailings with smart groups, removed members of the smart group were being included ([12945](https://github.com/civicrm/civicrm-core/pull/12945))**

- **Intelligently adjust menubar for D7 toolbar toggle ([12937](https://github.com/civicrm/civicrm-core/pull/12937))**

- **dev/core#443 Fix Non-static method calls at CRM_Utils_Mail_Incoming ([12934](https://github.com/civicrm/civicrm-core/pull/12934))**

- **Status page: hush menu should be on top of other headers ([12936](https://github.com/civicrm/civicrm-core/pull/12936))**

- **Correct inconsistent fileID reference ([12931](https://github.com/civicrm/civicrm-core/pull/12931))**

- **dev/financial#23  Do not display e-notice for zero dollar transactions ([12926](https://github.com/civicrm/civicrm-core/pull/12926))**

- **dev-core-166/lessen memory impact when running process_membership job([12306](https://github.com/civicrm/civicrm-core/pull/12306)) and ([12927](https://github.com/civicrm/civicrm-core/pull/12927)) and ([12918](https://github.com/civicrm/civicrm-core/pull/12918))**

- **Fix order by on is_primary. ([12765](https://github.com/civicrm/civicrm-core/pull/12765))**

- **Slay dragons ([12495](https://github.com/civicrm/civicrm-core/pull/12495))**

- **dev/core#357 Fix issue where user email addresses were keyed on email… ([12828](https://github.com/civicrm/civicrm-core/pull/12828))**

- **(dev/core#394) : Wildcards are ignored in some smart group criteria, when the smart group is directly generated for a mailing ([12910](https://github.com/civicrm/civicrm-core/pull/12910))**

- **core/384 CiviSMS does not fall back to non-primary mobile number ([12890](https://github.com/civicrm/civicrm-core/pull/12890))**

- **Do not treat an empty array as not set in caches. ([12784](https://github.com/civicrm/civicrm-core/pull/12784))**

- **Fix payment hangs when registering a user for a paid event without recording payment ([12914](https://github.com/civicrm/civicrm-core/pull/12914))**

- **Fix typo in hook that enables links to be added to a block ([12913](https://github.com/civicrm/civicrm-core/pull/12913))**

- **Show contact name on recurring contribution view and improve consistency with Contribution/Membership view ([12819](https://github.com/civicrm/civicrm-core/pull/12819))**

- **Contact layout editor support - Skip html encoding rich-text fields ([12841](https://github.com/civicrm/civicrm-core/pull/12841))**

- **ensure all valid relationship types are available ([12891](https://github.com/civicrm/civicrm-core/pull/12891))**

- **Ensure relative dates are preserved for custom fields in smart group ([12824](https://github.com/civicrm/civicrm-core/pull/12824))**

- **Send an 500 http response code when an exception is encountered. ([11821](https://github.com/civicrm/civicrm-core/pull/11821)) and ([12902](https://github.com/civicrm/civicrm-core/pull/12902))**

- **Register "short" and "long" cache services ([12873](https://github.com/civicrm/civicrm-core/pull/12873))**

- **Added a path to the drupal8 path candidates to find civicrm.config.php ([12903](https://github.com/civicrm/civicrm-core/pull/12903))**

- **GL-425: Log a message if CiviCRM thinks SSL is not enabled ([12908](https://github.com/civicrm/civicrm-core/pull/12908))**

- **Add `ext/` folder to .gitignore ([12905](https://github.com/civicrm/civicrm-core/pull/12905))**

- **dev/core#423 MySQL 5.7 complains about 4.7.19 upgrade script ([12898](https://github.com/civicrm/civicrm-core/pull/12898))**

- **Added missing field name in custom-field deletion dialog ([12869](https://github.com/civicrm/civicrm-core/pull/12869))**

- **Show recurring contribution links based on payment processor capabilities ([12821](https://github.com/civicrm/civicrm-core/pull/12821))**

- **dev/core#411 - Default currency shown on View participant and contrib… ([12875](https://github.com/civicrm/civicrm-core/pull/12875))**

- **Make datatables in Activities Relationship tab adjust to screen size ([12893](https://github.com/civicrm/civicrm-core/pull/12893))**

- **ensure search on survey results works properly ([12897](https://github.com/civicrm/civicrm-core/pull/12897))**

- **Remove crm.admin.js ([12884](https://github.com/civicrm/civicrm-core/pull/12884))**

- **Bring structural consistency to the plugin ([138](https://github.com/civicrm/civicrm-wordpress/pull/138))**

- **Export code cleanup and testing enhancements - this is an ongoing cleanup with an end goal of fixing some known bugs ([12586](https://github.com/civicrm/civicrm-core/pull/12586)) and  ([12864](https://github.com/civicrm/civicrm-core/pull/12864))**

- **Coding practices fix - Improve type checking in getContactPhone and use CRM_Utils_Request::r… ([12687](https://github.com/civicrm/civicrm-core/pull/12687))**

- **Code cleanup on activity api and activity dashboard query ([12994](https://github.com/civicrm/civicrm-core/pull/12994)) and ([12949](https://github.com/civicrm/civicrm-core/pull/12949))**

- **Code cleanup in api_v3_CaseTest ([12950](https://github.com/civicrm/civicrm-core/pull/12950))**

- **Code cleanup Membership form - submit status message ([12693](https://github.com/civicrm/civicrm-core/pull/12693)) and tidy up receipt code ([12695](https://github.com/civicrm/civicrm-core/pull/12695))**

- **Code cleanup and testing on query to generate annual totals ([12810](https://github.com/civicrm/civicrm-core/pull/12810))**

- **Code cleanup - commenting on  dupesInGroup() ([12920](https://github.com/civicrm/civicrm-core/pull/12920))**

- **Code cleanup - Fix spelling error ("sript" vs "script") ([12912](https://github.com/civicrm/civicrm-core/pull/12912))**

- **Code cleanup on recurring create action ([12900](https://github.com/civicrm/civicrm-core/pull/12900)) and viewing recurring rcords ([12899](https://github.com/civicrm/civicrm-core/pull/12899))**

- **Code cleanup (drupal) style fix for contact image handler ([537](https://github.com/civicrm/civicrm-drupal/pull/537))**

- **Code cleanup (wordpress) Give comments and docblocks some TLC ([137](https://github.com/civicrm/civicrm-wordpress/pull/137))**

- **Code cleanup  Fix comment as hook name was changed ([13009](https://github.com/civicrm/civicrm-core/pull/13009))**


### Wordpress

- **Allow user-defined shortcode components to be rendered ([134](https://github.com/civicrm/civicrm-wordpress/pull/134))**

- **Do not start session when running under WP-CLI ([135](https://github.com/civicrm/civicrm-wordpress/pull/135))**

- **Fix WP-CLI class for PHP 7.2 ([133](https://github.com/civicrm/civicrm-wordpress/pull/133))**

- **Fix malformed redirect URLs ([12969](https://github.com/civicrm/civicrm-core/pull/12969))**

### CiviMail

- **[CRM-19751](https://issues.civicrm.org/jira/browse/CRM-19751) Once "multiple bulk" setting, cannot search for opt out or on hold contacts ([12883](https://github.com/civicrm/civicrm-core/pull/12883))**

### CiviMail, Drupal Integration Modules

- **[CRM-17667](https://issues.civicrm.org/jira/browse/CRM-17667) Drush: Mail queue processing does not work ([354](https://github.com/civicrm/civicrm-drupal/pull/354))**

### Drupal Integration Modules

- **[CRM-20298](https://issues.civicrm.org/jira/browse/CRM-20298) Drupal Views: Custom fields of type Money should use the same filter operators as Integer fields ([435](https://github.com/civicrm/civicrm-drupal/pull/435))**

- **Add a drush command to rebuild SQL triggers ([545](https://github.com/civicrm/civicrm-drupal/pull/545))**

- **civicrm_handler_field_link_pcp: avoid PHP notice ([547](https://github.com/civicrm/civicrm-drupal/pull/547))**

## <a name="misc"></a>Miscellany

## <a name="credits"></a>Credits

This release was developed by the following code authors:

AGH Strategies - Alice Frumin, Andrew Hunt; Agileware - Alok Patel; Australian Greens - Seamus Lee; calbasi; Caltha - Tomasz Pietrzkowski; CEDC - Laryn Kragt Bakker; Chris Burgess; Christian Wach; CiviCoop - Klaas Eikelboom; CiviCRM - Coleman Watts, Tim Otten; CiviDesk - Yashodha Chaku; Community IT Academy - William Mortada; CompuCorp - Davi Alexandre; Coop SymbioTIC - Mathieu Lutfy, Samuel Vanhove; dereklewis123; Electronic Frontier Foundation - Mark Burdett; Fuzion - Jitendra Purohit; Ginkgo Street Labs - Frank Gómez; giovannidalmas1967; Jens Schuppe; JMA Consulting - Monish Deb; John Kingsnorth; Joinery - Allen Shaw; Joost Fock; Ken West; mecachisenros; Megaphone Technology Consulting - Jon Goldberg; MJW Consulting - Matthew Wire; Nicol Wistreich; OSSeed Technologies - Madhavi Malgaonkar; Pradeep Nayak; Progressive Technology Project - Jamie McClelland; Skvare - Mark Hanna; Third Sector Design - Michael McAndrew; Wikimedia Foundation - Eileen McNaughton, Elliott Eggleston

Most authors also reviewed code for this release; in addition, the following
reviewers contributed their comments:

AGH Strategies - Alice Frumin, Andrew Hunt; Agileware - Agileware Team; Australian Greens - Seamus Lee; British Humanist Association - Andrew West; calbasi; Caltha - Tomasz Pietrzkowski; CEDC - Laryn Kragt Bakker; Chris Burgess; Christian Wach; Circle Interactive - Dave Jenkins; civibot[bot]; civicrm-builder; CiviCRM - Coleman Watts, Tim Otten; CiviDesk - Yashodha Chaku; CiviFirst - John Kirk; Clairepickle; CompuCorp - Davi Alexandre, Jamie Novick; Coop SymbioTIC - Mathieu Lutfy; davej; dereklewis123; Donald Lobo; Electronic Frontier Foundation - Mark Burdett; Fuzion - Jitendra Purohit; Ginkgo Street Labs - Frank Gómez; giovannidalmas1967; iXiam - Vangelis Pantazis; JMA Consulting - Joe Murray, Monish Deb; John Kingsnorth; Joinery - Allen Shaw; JonScreat; Joost Fock; Ken West; kirk-jackson; Korlon - Stuart Gaston; Lighthouse Design and Consulting - Brian Shaughnessy; marsh-circle; mecachisenros; Megaphone Technology Consulting - Jon Goldberg; MJCO - Mikey O'Toole; MJW Consulting - Matthew Wire; Nicol Wistreich; Pradeep Nayak; Progressive Technology Project - Jamie McClelland; Richard van Oosterhout; Skvare - Mark Hanna; sleewok; Tadpole Collective - Kevin Cristiano; Tech To The People - Xavier Dutoit; Third Sector Design - Michael McAndrew; Wikimedia Foundation - Eileen McNaughton

## <a name="feedback"></a>Feedback

These release notes are edited by Andrew Hunt.  If you'd like to provide
feedback on them, please log in to https://chat.civicrm.org/civicrm and contact
`@agh1`.
